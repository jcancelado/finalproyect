{% extends 'base.html' %}
{% block content %}
  <div style="padding: 2rem; max-width: 600px; margin: 0 auto;">
    <h1>‚úèÔ∏è Editar Producto</h1>
    <p style="color: #666;">Tienda: <strong>{{ local_id }}</strong></p>
    
    {% if error %}
      <div class="alert alert-error">{{ error }}</div>
    {% endif %}
    
    <div class="card">
      <form method="post" enctype="multipart/form-data">
        <label for="nombre">
          Nombre del producto
          <input type="text" id="nombre" name="nombre" value="{{ producto.get('nombre', '') }}" required placeholder="Ej: Arroz integral" style="width: 100%;">
        </label>
        
        <label for="precio">
          Precio ($)
          <input type="number" id="precio" name="precio" step="0.01" value="{{ producto.get('precio', '') }}" required placeholder="Ej: 8200" style="width: 100%;">
        </label>
        
        <label for="stock">
          Stock (cantidad)
          <input type="number" id="stock" name="stock" value="{{ producto.get('stock', '') }}" required placeholder="Ej: 50" style="width: 100%;">
        </label>
        
        <label for="proveedor">
          Proveedor (opcional)
          <select id="proveedor" name="proveedor" style="width: 100%;">
            <option value="">-- Sin proveedor --</option>
            {% for prov_id, prov_data in proveedores.items() %}
              <option value="{{ prov_id }}" {% if producto.get('proveedor') == prov_id %}selected{% endif %}>
                {{ prov_data.nombre }}{% if prov_data.contacto %} ({{ prov_data.contacto }}){% endif %}
              </option>
            {% endfor %}
          </select>
        </label>
        
        <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #ddd;">
          <p style="color: #999; font-size: 0.9rem;">
            üì∏ Imagen actual: {% if producto.get('imagen_url') %}<a href="{{ producto.get('imagen_url') }}" target="_blank">Ver imagen</a>{% else %}No tiene{% endif %}
          </p>
          <label for="imagen_edit" style="display:block; margin-top:0.5rem;">
            Cambiar imagen (opcional):
            <input type="file" id="imagen_edit" name="imagen" accept=".png,.jpg,.jpeg,.gif,.webp" style="display:block; margin-top:0.5rem;">
          </label>
          <small style="color: #999; display: block; margin-bottom: 0.5rem;">Sube una nueva imagen para reemplazar la actual (PNG/JPG/GIF/WebP; m√°x 5MB)</small>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
          <button type="submit" style="padding: 0.75rem; background-color: #5cb85c; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">‚úÖ Guardar Cambios</button>
          <a href="{{ url_for('tendero_inventario', local_id=local_id) }}" style="padding: 0.75rem; background-color: #999; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; text-decoration: none; text-align: center; display: block;">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
